---
title: "2장. T-검정(T-test)"
output: html_document
---

### 1절. 일표본 T-검정 (One Sample T-Test)

#### 1. 일표본 T-검정이란?

: 단일 모집단에서 관심 있는 연속형 변수의 평균값을 특정 기준값과 비교

#### 2. 일표본 T-검정의 가정

-   모집단의 구성요소들이 정규분포를 이룬다.\
    ※ n이 30보다 클 경우, CLT에 의해 표본이 정규분포를 따른다.

#### 3. 일표본 T-검정의 단계

1.  가설 검정

$$ H_0 : \mu = \mu_0 $$

2.  유의 수준 설정
3.  검정통계량 값 및 유의확률 계산

검정통계량 값 :

$$
t_0 = \frac{\bar x-\mu_0}{s/\sqrt n} \sim t(df) \ , \; df = n-1
$$

=\> p-value \< $\alpha$ : 귀무가설 기각\

------------------------------------------------------------------------

#### R code

-   정규성 검정 - shapiro.test(data)

※ 귀무가설은 '데이터가 정규분포를 따른다' =\> p-value \> $\alpha$ 일 때 정규분포를 따름.

i\. 정규분포를 따를 때,\
t.test(x, alternative=c('two.sided','less','greater'), mu=0)

ii\. 정규분포를 따르지 않을 때,\
wilcox.test(x, alternative=c('two.sided','less','greater'), mu=0)

```{r}
library(MASS)

str(cats)

shapiro.test(cats$Bwt)
```

=\> p-value 가 유의수준 0.05보다 작으므로 '데이터가 정규분포를 따른다'라는 귀무가설을 기각

=\> 일표본 t-검정으로서 wilcox.test 진행

```{r}
wilcox.test(cats$Bwt, mu=2.6, alternative = 'two.sided')
```

=\> 귀무가설 '고양이들의 평균 몸무게가 2.6이다'을 기각한다.

### 2절. 대응표본 T-검정 (Paired Sample T-Test)

#### 1. 대응표본 T-검정이란?

|   개체   | 관측값1(A) | 관측값2(B) |  차이(A-B=D)  |
|:--------:|:----------:|:----------:|:-------------:|
|    1     |   $A_1$    |   $B_1$    | $A_1-B_1=D_1$ |
|    2     |   $A_2$    |   $B_2$    | $A_2-B_2=D_2$ |
| $\vdots$ |  $\vdots$  |  $\vdots$  |   $\vdots$    |
|    n     |   $A_n$    |   $B_n$    | $A_n-B_n=D_n$ |

: **단일모집단**에 대해 두 번의 처리를 가했을 때, 두 개의 처리에 따른 평균의 차이를 비교

#### 2. 대응표본 T-검정의 가정

-   모집단의 관측값이 정규성을 만족

#### 3. 대응표본 T-검정의 단계

1.  가설 검정

    $$ H_0 : \mu_x-\mu_y=D=0 $$

2.  유의수준 설정

3.  검정통계량의 값 및 유의확률 계산

검정통계량의 값 :

$$
t = \frac{\bar D - (\mu_x-\mu_y)}{s_D/\sqrt n} \sim t(df)\ , \; df=n-1 
$$

=\> p-value \< $\alpha$ : 귀무가설 기각

------------------------------------------------------------------------

#### R code

-   t.test(x,y, alternative=c('two.sided','less','greater'), paired=FALSE, m=0)

```{r}
df <- data.frame(before = c(7,3,4,5,2,1,6,6,5,4),
                 after = c(8,4,5,6,2,3,6,8,6,5))
df

t.test(df$before,df$after, alternative = 'less', paired = TRUE)
```

=\> p-value \< 0.05 이므로 귀무가설 '복용 전과 후의 평균 수면시간에는 차이가 없다'를 기각한다

### 3절. 독립표본 T-검정 (Independent Sample T-Test)

#### 1. 독립표본 T-검정이란?

: 두 개의 독립된 모집단의 평균을 비교

#### 2. 독립표본 T-검정의 가정

-   두 모집단이 정규성을 만족

-   두 모집단은 서로 독립적

-   두 모집단이 등분산성 가정(두 독립 집단의 모분산이 동일)

#### 3. 독립표본 T-검정의 단계

1.  가설검정

$$
H_0 : \mu_1 = \mu_2
$$

2.  유의수준 설정
3.  등분산 검정

$$
H_0 : \sigma_1^2 = \sigma_2^2 \\
H_1 : \sigma_1^2 \ne \sigma_2^2
$$

4.  검정통계량의 값 및 유의확률 계산

검정통계량의 값 :

$$
t = \frac{(\bar {X_1} - \bar {X_2})-D_0}{s \sqrt {\frac{1}{n_1}+\frac{1}{n_2}}} \sim t(df) \ , \; df=n_1+n_2-2
$$

------------------------------------------------------------------------

#### R code

-   등분산 검정 - var.test()

```{r}
library(MASS)
data('cats')

var.test(Bwt~Sex, data = cats)
```

=\> p-value \< 0.05 이므로 등분산성을 만족하지 않는다.

-   독립표본 T-검정 - t.test(..., var.equal=FALSE)\
    ※ var.equal : 등분산성을 만족하는지의 여부

```{r}
t.test(Bwt~Sex, data = cats, alternative='two.sided', var.equal=FALSE)
```

=\> p-value \< 0.05 이므로 귀무가설'고양이들의 성별에 따른 평균 몸무게에는 통계적으로 유의한 차이가 없다'를 기각한다

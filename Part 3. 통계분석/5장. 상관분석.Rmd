---
title: "5장. 상관분석"
output:
  md_document:
    variant: markdown_github
---

### 1절. 상관분석의 개념

#### 1. 상관분석

: 두 변수 간 관계의 정도를 알아보기 위한 분석방법

$$ r = \frac{cov(x,y)}{S_x * S_y}=\frac{\sum^n_{i=1}[(x-\bar x)(y-\bar y)]}{n(S_x*S_y)} $$ 상관계수 값이 클수록 데이터 간의 관계가 존재한다.

#### 2. 공분산과 상관계수

-   공분산 : 두 확률변수가 함께 변화하는지의 정도를 측정

#### 3. 상관계수의 해석

|      상관계수 범위      |            해석             |
|:-----------------------:|:---------------------------:|
|  $|0.7| < \rho \le|1|$  |      강한 상관이 있다.      |
| $|0.3| < \rho \le|0.7|$ |      약한 상관이 있다.      |
|    $0<\rho\le|0.3|$     |      거의 상관이 없다.      |
|        $\rho=0$         | 상관관계가 존재하지 않는다. |

### 2절. 상관분석의 유형

#### 1. 피어슨 상관계수

: 두 **연속형** 자료가 모두 **정규성**을 따른다는 가정 하에 선형적 상관관계를 측정, -1\~1 값

#### 2. 스피어만 상관계수

: 두 변수가 **정규성을 만족하지 않는** 경우 or 변수가 **순위 및 순서** 형태인 경우 상관관계 사용, -1\~1 값

비선형 관계의 연관성도 파악 가능

#### 3. 켄달의 순위상관계수

: 데이터가 \$(X_i,Y_i) \$ 와 같이 순서쌍으로 주어졌을 경우, -1\~1값

-   부합 : $X_i$ 가 커짐에 따라 $Y_i$ 도 커질 경우

-   비부합 : $X_i$ 가 커짐에 따라 $Y_i$ 도 작아질 경우

=\> 1 일 경우, 부합쌍의 비율이 100% / -1 일 경우, 비부합쌍의 비율이 100%

### 3절. 상관계수 검정

#### 1. 상관계수에 대한 검정

$H_0$ : 두 변수 간에는 상관관계가 없다. (상관계수=0)

#### 2. R을 이용한 상관분석

-   상관계수 - cor(x,y, method=c('pearson','kendall','spearman'), use)

    -   use : na값 처리 방법

        -   everything : 결측값 존재 시 NA

        -   all.obs : 결측값 존재시 오류 메시지

        -   complete.obs : 변수별로 결측값을 제외하고 상관계수 계산

        -   pairwise.complete.obs : 모든 변수 쌍에서 결측값이 없는 데이터들에 대해 상관계수 계산

```{r}
data("airquality")
str(airquality)

air <- airquality[,c(1:4)]
str(air)

# 피어슨 상관계수
cor(air, use = 'pairwise.complete.obs', method = 'pearson')

# 켄달 상관계수
cor(air, use = 'pairwise.complete.obs', method = 'kendall')

# 스피어만 상관계수
cor(air, use = 'pairwise.complete.obs', method = 'spearman')
```

-   상관계수에 대한 가설 검정 - cor.test()

```{r}
cor.test(air$Ozone, air$Wind, method = 'pearson')
```

=\> p-value \< 0.05이므로 귀무가설을 기각한다. 따라서 두 변수 사이에 상관관계가 존재한다

-   상관계수 행렬을 시각화 - pairs(),corrplot()

```{r}
air_cor <- cor(air, use = 'pairwise.complete.obs')
air_cor

pairs(air_cor)
```

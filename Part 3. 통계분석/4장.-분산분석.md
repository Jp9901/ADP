### 1절. 일원배치 분산분석 (one-way ANOVA)

#### 1. 분산분석의 개념

: 두 개 이상 집단들의 평균 값 차이에 대한 통계적 유의성을 검증하는 방법

#### 2. 일원배치 분산분석의 개념

: 반응값에 대한 하나의 범주형 변수의 영향을 알아보기 위해 사용되는 검증
방법 =\> F 검정 통계량

#### 3. 일원배치 분산분석의 가정

-   각 집단의 측정치는 서로 독립이며, 정규분포를 따른다.

-   각 집단의 측청치의 분산은 같다. (등분산 가정)

#### 4. 분산분석표

| 요인 | 제곱합 | 자유도 | 평균제곱 |   분산비    |
|:----:|:------:|:------:|:--------:|:-----------:|
| 처리 |  SSA   |  k-1   |   MSA    | F = MSA/MSE |
| 오차 |  SSE   |  N-k   |   MSE    |             |
| 전체 |  SST   |  N-1   |          |             |

-   SSA (집단이 가지는 변동제곱합) :
    $n \sum^k\_{i=1}(\bar {X_i} - \bar {X})^2$

-   SSE (오차가 가지는 변동제곱합) :
    $\sum^k\_{i=1} \sum^m\_{j=1}(X\_{ij} - \bar {X_i})^2$

-   SST (관측치 값이 가지는 변동제곱합) :
    $\sum^k\_{i=1} \sum^m\_{j=1}(X\_{ij} - \bar {X})^2$

    ※ SST = SSA + SSE

#### 5. 가설 검정

*H*<sub>0</sub> : k개의 집단 간 모평균에는 차이가 없다 (
*μ*<sub>1</sub> = *μ*<sub>2</sub> = ⋯ = *μ*<sub>*k*</sub> )

#### 6. 사후 검정

: 분산분석 결과 귀무가설이 기각되어 적어도 한 집단에서 평균의 차이가
있음이 통계적으로 증명되었을 경우,  
어떤 집단들에 대해서 평균의 차이가 존재하는지 알아보기 위해 실시하는
분석  
-\> 두 집단씩 짝을 지어 각각 다중비교

던칸의 MRT, 피셔의 최소유의차(LSD) 방법, 튜키의 HSD방법, Scheffe의 방법

#### 7. R을 활용한 일원배치 분산분석

-   분산분석 - aov

``` r
data("iris")

result <- aov(Sepal.Width ~ Species , data = iris)
summary(result)
```

    ##              Df Sum Sq Mean Sq F value Pr(>F)    
    ## Species       2  11.35   5.672   49.16 <2e-16 ***
    ## Residuals   147  16.96   0.115                   
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

=\> p-value \< 0.05 이므로 귀무가설 ’세 가지 종들에 대해 꽃받침 폭의
평균이 동일하다’를 기각한다.

-   사후분석 - TukeyHSD

``` r
library(broom)
TukeyHSD(result)
```

    ##   Tukey multiple comparisons of means
    ##     95% family-wise confidence level
    ## 
    ## Fit: aov(formula = Sepal.Width ~ Species, data = iris)
    ## 
    ## $Species
    ##                        diff         lwr        upr     p adj
    ## versicolor-setosa    -0.658 -0.81885528 -0.4971447 0.0000000
    ## virginica-setosa     -0.454 -0.61485528 -0.2931447 0.0000000
    ## virginica-versicolor  0.204  0.04314472  0.3648553 0.0087802

=\> 사후 분석 결과, 모든 p-value(p adj) \< 0.05 이므로 모든 종들에
대해서 꽃받침 폭의 평균값이 통계적으로 유의한 차이가 있다.

### 2절. 이원배치 분산분석 (Two-way ANOVA)

#### 1. 이원배치 분산분석의 개념

: 반응값에 대해 두 개의 범주형 변수 A,B의 영향을 알아보기 위해 사용되는
검증 방법

※ 두 독립변수 A, B 사이에 상관관계가 있는지를 살펴보는 교호작용(두
독립변수의 범주들의 조합으로 인해 반응변수에 미치는 특별한 영향)에 대한
검증 반드시 필요

#### 2. 이원배치 분산분석의 가정

-   각 집단 측정치의 분포는 정규분포이어야 한다.(정규성)

-   집단 간 측정치의 분산은 같다. (등분산성)

#### 3. 주효과와 교호작용효과

두 개의 독립변수 값에 따르는 데이터의 주효과와 상호작용효과에 대한 검정
수행

주효과 : 각각의 독립변수가 종속변수에 미치는 영향

교호작용효과 : 여러 독립변수들의 조합이 종속변수에 미치는 영향 =\>
상관관계가 존재할 경우, 교호작용O

#### 4. 분산분석표

|   **요인**    |       **제곱합**        | **자유도**  |             **평균제곱합**             |             **F**              |
|:------------:|:------------:|:-------------:|:---------------:|:------------:|
|  **요인 A**   |  *S**S*<sub>*A*</sub>   |     I-1     |         $MS_A=\frac{SSA}{I-1}$         |     $F_A=\frac{MSA}{MSE}$      |
|  **요인 B**   |  *S**S*<sub>*B*</sub>   |     J-1     |         $MS_B=\frac{SSB}{J-1}$         |     $F_B=\frac{MSB}{MSE}$      |
| **상호 작용** | *S**S*<sub>*A**B*</sub> | (I-1)(J-1)  | $MS\_{AB}=\frac{SS\_{AB}}{(I-1)(J-1)}$ | $F\_{AB}=\frac{MS\_{AB}}{MSE}$ |
|   **오차**    |           SSE           | I\*J\*(n-1) |     $MSE=\frac{SSE}{I\*J\*(n-1)}$      |                                |
|   **전체**    |           SST           |  I\*J\*n-1  |                                        |                                |

#### 5. 가설 검정

-   *H*<sub>0</sub> :
    *α*<sub>1</sub> = *α*<sub>2</sub> = ⋯ = *α*<sub>*a*</sub> = 0  
    ( *α* 변수에 따른 종속변수의 값에 차이가 없다.)

-   *H*<sub>0</sub> :
    *β*<sub>1</sub> = *β*<sub>2</sub> = ⋯ = *β*<sub>*b*</sub> = 0  
    ( *β* 변수에 따른 종속변수의 값에 차이가 없다.)

-   *H*<sub>0</sub> :
    *α*<sub>1</sub>*β*<sub>1</sub> + *α*<sub>2</sub>*β*<sub>2</sub> = ⋯ = *α*<sub>*a* − 1</sub>*β*<sub>*b* − 1</sub> = 0  
    ( *α*와 *β*변수의 상호작용 효과가 없다. )

#### 6. R을 활용한 이원배치 분산분석

-   이원배치 분산분석 - aov

``` r
data('mtcars')
str(mtcars)
```

    ## 'data.frame':    32 obs. of  11 variables:
    ##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
    ##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
    ##  $ disp: num  160 160 108 258 360 ...
    ##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
    ##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
    ##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
    ##  $ qsec: num  16.5 17 18.6 19.4 17 ...
    ##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
    ##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
    ##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
    ##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...

``` r
mtcars$cyl <- as.factor(mtcars$cyl)
mtcars$am <- as.factor(mtcars$am)

car <- mtcars[,c('cyl','am','mpg')]
str(car)
```

    ## 'data.frame':    32 obs. of  3 variables:
    ##  $ cyl: Factor w/ 3 levels "4","6","8": 2 2 1 2 3 2 3 1 1 2 ...
    ##  $ am : Factor w/ 2 levels "0","1": 2 2 2 1 1 1 1 1 1 1 ...
    ##  $ mpg: num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...

``` r
car_aov <- aov(mpg~cyl*am, car)
summary(car_aov)
```

    ##             Df Sum Sq Mean Sq F value   Pr(>F)    
    ## cyl          2  824.8   412.4  44.852 3.73e-09 ***
    ## am           1   36.8    36.8   3.999   0.0561 .  
    ## cyl:am       2   25.4    12.7   1.383   0.2686    
    ## Residuals   26  239.1     9.2                     
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

=\> cyl 변수에 대한 p-value \< 0.05 이므로 귀무가설 ’실린더 개수에 따른
주행거리 평균간 차이는 존재하지 않는다.’를 기각한다.

=\> am 변수에 대한 p-value \> 0.05 이므로 귀무가설 ’변수기 종류에 따른
주행거리 평균간 차이는 존재하지 않는다.’를 기각하지 않는다.

=\> cyl변수와 am변수 간의 상호작용효과에 대해 p-vale \> 0.05 이므로
귀무가설 ’교호작용이 존재하지 않는다’을 기각하지 않는다.

-   두 개의 독립변수들 간의 상호작용효과 시각화 -
    interaction.plot(x.factor, trace.factor, response)

    -   x.factor : x축에 그릴 그룹변수

    -   trace.factor : 그래프에 표현할 그룹변수

    -   response : 반응변수값을 저장한 벡터

``` r
interaction.plot(car$cyl, car$am, car$mpg, col=c('red','blue'))
```

![](4장.-분산분석_files/figure-markdown_github/unnamed-chunk-4-1.png)

※ <u>**두 선이 교차하고 있을 때, 두 독립변수 간에 상호작용이 존재**</u>

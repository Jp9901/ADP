---
title: "3장. 교차분석"
output: html_document
---

### 1절. 교차분석 개념

#### 1. 교차분석의 개념 및 특징

: 범주형 자료인 두 변수 간의 관계를 알아보기 위해 실시하는 분석 기법

적합성 검정, 독립성 검정, 동질성 검정 -\> 카이제곱 검정 통계량

#### 2. 교차표

|                   | $\mathbf{A_1}$ | $\mathbf{A_2}$ | $\mathbf{\cdots}$ | $\mathbf{A_N}$ |    Total     |
|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|
|  $\mathbf{B_1}$   |    $O_{11}$    |    $O_{12}$    |     $\cdots$      |    $O_{1N}$    | $T_{1\cdot}$ |
|  $\mathbf{B_2}$   |    $O_{21}$    |    $O_{22}$    |     $\cdots$      |    $O_{2N}$    | $T_{2\cdot}$ |
| $\mathbf{\vdots}$ |    $\vdots$    |    $\vdots$    |     $\ddots$      |    $\vdots$    |   $\vdots$   |
|  $\mathbf{B_M}$   |    $O_{M1}$    |    $O_{M2}$    |     $\cdots$      |    $O_{MN}$    | $T_{M\cdot}$ |
|     **Total**     |  $T_{\cdot1}$  |  $T_{\cdot2}$  |     $\cdots$      | $T_{\cdot N}$  |      T       |

### 2절. 적합성 검정

#### 1. 적합성 검정이란?

: 모집단 분포에 대한 가정이 옳게 됐는지를 관측 자료와 비교하여 검정하는 것

#### 2. 가설 설정

$H_0$ : 실제 분포와 이론적 분포 간에는 차이가 없다. (두 분포가 일치한다.)

$H_1$ : 실제 분포와 이론적 분포 간에는 차이가 있다. (두 분포가 일치하지 않는다.)

#### 3. 검정 통계량

$$
\chi^2 = \sum_{i=1}^k{\frac{(O_i-E_i)^2}{E_i}}
$$

=\> $\chi^2$ 통계량 값이 큰 경우, 적합도가 낮다. (일치한다고 볼 수 없다.)

#### 4. 자유도

df = k-1 , where k = 범주의 개수

#### 5. R을 이용한 적합성 검정

-   chisq.test(x, y, p)\
    ※ p : 귀무가설을 통해 설정한 확률 값

```{r}
data("survey", package = 'MASS')

str(survey)
dt <- table(survey$W.Hnd)
dt

chisq.test(dt, p=c(0.2,0.8))
```

=\> p-value \< 0.05 이므로 귀무가설 '왼손잡이의 20%, 오른손잡이 80%이다.' 를 기각한다.

### 3절. 독립성 검정

#### 1. 독립성 검정이란?

: 모집단이 두 개의 변수 A, B에 의해 범주화되었을 때, 두 변수들 사이의 관계가 독립인지 검정

#### 2. 가설 설정

$H_0$ : 두 변수 사이에는 연관이 없다. (독립이다.)

$H_1$ : 두 변수 사이에는 연관이 있다. (종속이다.)

#### 3. 검정 통계량

$$
\chi^2 = \sum^r_{i=1} \sum^c_{j=1} \frac{(O_{ij}-E_{ij})^2}{E_{ij}} \ , \ where \ E_{ij} = \frac{O_{i\cdot} * O_{\cdot j}}{n}  (기대빈도)
$$

=\> $\chi^2$ 통계량 값이 큰 경우, 두 변수 사이에는 연관이 있다. (종속 관계)

#### 4. 자유도

df = (R-1)(C-1) , where R : 행의 수, C : 열의 수

#### 5. R을 이용한 독립성 검정

-   분할표

    1.  xtabs
    2.  table

```{r}
data("survey", package = "MASS")

xtabs(~W.Hnd+Exer, data = survey)

table(survey$W.Hnd, survey$Exer)
```

-   독립성 검정 - chisq.test(table())

```{r warning=FALSE}
chisq.test(table(survey$W.Hnd, survey$Exer))
```

=\> p-value \> 0.05 이므로 귀무가설'두 변수가 독립이다.'를 기각하지 않는다.

### 4절. 동질성 검정

#### 1. 동질성 검정이란?

: 모집단이 임의의 변수에 따라 R개의 속성으로 범주화되었을 때, R개의 부분 모집단에서 추출한 각 표본인 C개의 범주화된 집단의 분포가 서로 동일한지 검정

독립성 검정과 동일

#### 2. 가설 설정

$H_0 : P_{1j} = P_{2j} = \cdots = P_{rj}$

#### 3. 검정 통계량

$$
\chi^2 = \sum^r_{i=1} \sum^c_{j=1} \frac{(O_{ij}-E_{ij})^2}{E_{ij}} \ , \ where \ E_{ij} = \frac{O_{i\cdot} * O_{\cdot j}}{n}  (기대빈도)
$$

#### 4. 자유도

df = (R-1)(C-1)

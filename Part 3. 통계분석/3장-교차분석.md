### 1절. 교차분석 개념

#### 1. 교차분석의 개념 및 특징

: 범주형 자료인 두 변수 간의 관계를 알아보기 위해 실시하는 분석 기법

적합성 검정, 독립성 검정, 동질성 검정 -\> 카이제곱 검정 통계량

#### 2. 교차표

|                       | **A**<sub>**1**</sub> | **A**<sub>**2**</sub> | **⋯** | **A**<sub>**N**</sub> |       Total        |
|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|
| **B**<sub>**1**</sub> |   *O*<sub>11</sub>    |   *O*<sub>12</sub>    |   ⋯   |  *O*<sub>1*N*</sub>   |  *T*<sub>1⋅</sub>  |
| **B**<sub>**2**</sub> |   *O*<sub>21</sub>    |   *O*<sub>22</sub>    |   ⋯   |  *O*<sub>2*N*</sub>   |  *T*<sub>2⋅</sub>  |
|         **⋮**         |           ⋮           |           ⋮           |   ⋱   |           ⋮           |         ⋮          |
| **B**<sub>**M**</sub> |  *O*<sub>*M*1</sub>   |  *O*<sub>*M*2</sub>   |   ⋯   | *O*<sub>*M**N*</sub>  | *T*<sub>*M*⋅</sub> |
|       **Total**       |   *T*<sub>⋅1</sub>    |   *T*<sub>⋅2</sub>    |   ⋯   |  *T*<sub>⋅*N*</sub>   |         T          |

### 2절. 적합성 검정

#### 1. 적합성 검정이란?

: 모집단 분포에 대한 가정이 옳게 됐는지를 관측 자료와 비교하여 검정하는
것

#### 2. 가설 설정

*H*<sub>0</sub> : 실제 분포와 이론적 분포 간에는 차이가 없다. (두 분포가
일치한다.)

*H*<sub>1</sub> : 실제 분포와 이론적 분포 간에는 차이가 있다. (두 분포가
일치하지 않는다.)

#### 3. 검정 통계량

$$
\chi^2 = \sum\_{i=1}^k{\frac{(O_i-E_i)^2}{E_i}}
$$

=\> *χ*<sup>2</sup> 통계량 값이 큰 경우, 적합도가 낮다. (일치한다고 볼
수 없다.)

#### 4. 자유도

df = k-1 , where k = 범주의 개수

#### 5. R을 이용한 적합성 검정

-   chisq.test(x, y, p)  
    ※ p : 귀무가설을 통해 설정한 확률 값

``` r
data("survey", package = 'MASS')

str(survey)
```

    ## 'data.frame':    237 obs. of  12 variables:
    ##  $ Sex   : Factor w/ 2 levels "Female","Male": 1 2 2 2 2 1 2 1 2 2 ...
    ##  $ Wr.Hnd: num  18.5 19.5 18 18.8 20 18 17.7 17 20 18.5 ...
    ##  $ NW.Hnd: num  18 20.5 13.3 18.9 20 17.7 17.7 17.3 19.5 18.5 ...
    ##  $ W.Hnd : Factor w/ 2 levels "Left","Right": 2 1 2 2 2 2 2 2 2 2 ...
    ##  $ Fold  : Factor w/ 3 levels "L on R","Neither",..: 3 3 1 3 2 1 1 3 3 3 ...
    ##  $ Pulse : int  92 104 87 NA 35 64 83 74 72 90 ...
    ##  $ Clap  : Factor w/ 3 levels "Left","Neither",..: 1 1 2 2 3 3 3 3 3 3 ...
    ##  $ Exer  : Factor w/ 3 levels "Freq","None",..: 3 2 2 2 3 3 1 1 3 3 ...
    ##  $ Smoke : Factor w/ 4 levels "Heavy","Never",..: 2 4 3 2 2 2 2 2 2 2 ...
    ##  $ Height: num  173 178 NA 160 165 ...
    ##  $ M.I   : Factor w/ 2 levels "Imperial","Metric": 2 1 NA 2 2 1 1 2 2 2 ...
    ##  $ Age   : num  18.2 17.6 16.9 20.3 23.7 ...

``` r
dt <- table(survey$W.Hnd)
dt
```

    ## 
    ##  Left Right 
    ##    18   218

``` r
chisq.test(dt, p=c(0.2,0.8))
```

    ## 
    ##  Chi-squared test for given probabilities
    ## 
    ## data:  dt
    ## X-squared = 22.581, df = 1, p-value = 2.015e-06

=\> p-value \< 0.05 이므로 귀무가설 ‘왼손잡이의 20%, 오른손잡이
80%이다.’ 를 기각한다.

### 3절. 독립성 검정

#### 1. 독립성 검정이란?

: 모집단이 두 개의 변수 A, B에 의해 범주화되었을 때, 두 변수들 사이의
관계가 독립인지 검정

#### 2. 가설 설정

*H*<sub>0</sub> : 두 변수 사이에는 연관이 없다. (독립이다.)

*H*<sub>1</sub> : 두 변수 사이에는 연관이 있다. (종속이다.)

#### 3. 검정 통계량

$$
\chi^2 = \sum^r\_{i=1} \sum^c\_{j=1} \frac{(O\_{ij}-E\_{ij})^2}{E\_{ij}} \\, \\where \\E\_{ij} = \frac{O\_{i\cdot} \* O\_{\cdot j}}{n}  (기대빈도)
$$

=\> *χ*<sup>2</sup> 통계량 값이 큰 경우, 두 변수 사이에는 연관이 있다.
(종속 관계)

#### 4. 자유도

df = (R-1)(C-1) , where R : 행의 수, C : 열의 수

#### 5. R을 이용한 독립성 검정

-   분할표

    1.  xtabs
    2.  table

``` r
data("survey", package = "MASS")

xtabs(~W.Hnd+Exer, data = survey)
```

    ##        Exer
    ## W.Hnd   Freq None Some
    ##   Left     7    3    8
    ##   Right  107   21   90

``` r
table(survey$W.Hnd, survey$Exer)
```

    ##        
    ##         Freq None Some
    ##   Left     7    3    8
    ##   Right  107   21   90

-   독립성 검정 - chisq.test(table())

``` r
chisq.test(table(survey$W.Hnd, survey$Exer))
```

    ## 
    ##  Pearson's Chi-squared test
    ## 
    ## data:  table(survey$W.Hnd, survey$Exer)
    ## X-squared = 1.2065, df = 2, p-value = 0.547

=\> p-value \> 0.05 이므로 귀무가설’두 변수가 독립이다.’를 기각하지
않는다.

### 4절. 동질성 검정

#### 1. 동질성 검정이란?

: 모집단이 임의의 변수에 따라 R개의 속성으로 범주화되었을 때, R개의 부분
모집단에서 추출한 각 표본인 C개의 범주화된 집단의 분포가 서로 동일한지
검정

독립성 검정과 동일

#### 2. 가설 설정

*H*<sub>0</sub> : *P*<sub>1*j*</sub> = *P*<sub>2*j*</sub> = ⋯ = *P*<sub>*r**j*</sub>

#### 3. 검정 통계량

$$
\chi^2 = \sum^r\_{i=1} \sum^c\_{j=1} \frac{(O\_{ij}-E\_{ij})^2}{E\_{ij}} \\, \\where \\E\_{ij} = \frac{O\_{i\cdot} \* O\_{\cdot j}}{n}  (기대빈도)
$$

#### 4. 자유도

df = (R-1)(C-1)

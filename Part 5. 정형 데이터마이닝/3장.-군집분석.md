``` r
# credit card
credit <- read.csv('german_credit.csv')
credit$Creditability <- as.factor(credit$Creditability)

set.seed(1)
idx <- sample(1:nrow(credit),nrow(credit)*0.7,replace=F)
train <- credit[idx,]
test <- credit[-idx,]
```

### 1절. 군집분석

#### 1. 개요

유사성이 높은 대상 집단을 분류, 군집이 속한 객체들의 유사성과 서로 다른
군집에 속한 객체 간의 상이성을 규명하는 분석 방법

#### 2. 특징

-   요인분석과 차이점 : 요인분석은 유사한 변수를 함께 묶어줌

-   판별분석과 차이점 : 사전에 집단이 나누어져 있는 자료를 통해 새로운
    데이터를 기존의 집단에 할당

#### 3. 거리

i\. 연속형 변수

-   유클리디안 거리

    $$
    d(x,y)=\sqrt{(x_1-y_1)^2+\cdots+(x_p-y_p)^2}
    $$

-   표준화 거리

    $$
    d(x,y) = \sqrt{(x-y)^\`D^{-1}(x-y)} \\ , \quad D = diag\\s\_{11},...,s\_{pp}\\ 
    $$

-   마할라노비스 거리

    $$
    d(x,y)=\sqrt{(x-y)^\`S^{-1}(x-y)}\\ , \quad S=\\S\_{ij}\\는 \\ 공분산행렬 
    $$

-   체비셰프 거리

    *d*(*x*,*y*) = *m**a**x*<sub>*i*</sub>\|*x*<sub>*i*</sub>−*y*<sub>*i*</sub>\|

-   맨하탄 거리

    $$
    d(x,y) = \sum^p\_{i=1} \|x_i-y_i\|
    $$

-   캔버라 거리

    $$
    d(x,y)=\sum^p\_{i=1} \frac{\|x_i-y_i\|}{(x_i+y_i)}
    $$

-   민코우스키 거리

    $$
    d(x,y)=\[\sum^p\_{i=1}\|x_i-y_i\|^m\]^{1/m} \quad m=1 \\ or\\  2
    $$

ii\. 범주형 변수

-   자카드 거리

    $$
    1-J(A,B)=\frac{\|A \cup B\|-\|A \cap B\|}{\|A \cup B\|}
    $$

-   자카드 계수

    $$
    J(A,B)=\frac{\|A \cap B\|}{\|A \cup B\|}
    $$

-   코사인 유사도

    $$
    cosine \\ similarity = 1-\frac{A \bullet B}{\|\|A\|\|\_2 \bullet \|\|B\|\|\_2}
    $$

### 2절. 계층적 군집분석

: n개의 군집으로 시작해 점차 군집의 개수를 줄여 나가는 방법

#### 1. 계충적 군집분석 종류

1.  최단연결법
2.  최장연결법
3.  평균연결법
4.  와드연결법
5.  군집화

##### R

-   dist(data, method)

    -   method : 거리측정
        방법(‘euclidean’,‘maximum’,‘manhattan’,‘canberra’,binary’,‘minkowski’)

-   hclust(data, method)

    -   data : dist 함수로 거리가 측정된 데이터

    -   method : 거리측정 방법
        (‘single’,‘complete’,‘average’,‘median’,‘ward.D’)

``` r
data("USArrests")
head(USArrests)
```

    ##            Murder Assault UrbanPop Rape
    ## Alabama      13.2     236       58 21.2
    ## Alaska       10.0     263       48 44.5
    ## Arizona       8.1     294       80 31.0
    ## Arkansas      8.8     190       50 19.5
    ## California    9.0     276       91 40.6
    ## Colorado      7.9     204       78 38.7

``` r
# dist 함수
US.dist <- dist(USArrests, 'euclidean')
US.dist
```

    ##                   Alabama     Alaska    Arizona   Arkansas California
    ## Alaska          37.177009                                            
    ## Arizona         63.008333  46.592489                                 
    ## Arkansas        46.928137  77.197409 108.851918                      
    ## California      55.524769  45.102217  23.194180  97.582017           
    ## Colorado        41.932565  66.475935  90.351148  36.734861  73.197131
    ## Connecticut    128.206942 159.406556 185.159526  85.028289 169.277110
    ## Delaware        16.806249  45.182961  58.616380  53.010376  49.291480
    ## Florida        102.001618  79.974496  41.654532 148.735739  60.980735
    ## Georgia         25.841827  57.030255  86.037957  25.586129  73.997297
    ## Hawaii         191.803050 221.193535 248.268967 147.775979 231.071093
    ## Idaho          116.761980 146.484982 176.817674  70.587038 162.612792
    ## Illinois        28.454877  42.911653  45.697812  67.770274  32.718802
    ## Indiana        123.345207 152.804090 181.897801  78.478086 166.229961
    ## Iowa           180.610105 209.983523 239.991458 134.594948 224.634659
    ## Kansas         121.519875 151.480197 180.028914  76.753436 164.516747
    ## Kentucky       127.284170 156.612037 187.690303  81.092848 173.207910
    ## Louisiana       15.454449  32.348879  48.494639  61.545512  41.635562
    ## Maine          154.145289 183.897526 214.327413 107.850730 199.931113
    ## Maryland        64.993615  44.839492  15.015991 111.642913  36.347352
    ## Massachusetts   91.648513 123.254209 145.875906  54.181178 129.524708
    ## Michigan        28.485435  28.857755  39.872422  71.100281  27.746351
    ## Minnesota      164.650964 194.253571 223.088256 119.324641 207.222537
    ## Mississippi     27.390144  28.635118  52.708728  69.685364  55.683570
    ## Missouri        59.788293  89.306719 116.467377  24.894377 100.988910
    ## Montana        127.392621 156.673578 187.540849  81.163107 172.996069
    ## Nebraska       134.436974 164.114259 193.423602  88.978930 178.100814
    ## Nevada          37.430469  34.886817  44.797433  74.288694  26.746962
    ## New Hampshire  179.736196 209.254415 239.255616 133.678308 224.055395
    ## New Jersey      83.243018 114.735566 135.850396  49.844257 119.041169
    ## New Mexico      51.643489  33.521933  13.896043  97.931200  24.495102
    ## New York        33.710829  43.182983  40.853519  73.762118  26.900929
    ## North Carolina 101.961022  79.376067  57.619615 147.184238  80.332123
    ## North Dakota   192.416138 221.378590 252.808188 145.855545 238.214462
    ## Ohio           117.387606 147.373335 174.338177  74.369752 157.998513
    ## Oklahoma        85.848704 116.429421 143.931407  43.012673 128.779346
    ## Oregon          78.386861 106.930117 135.672879  36.895122 120.039577
    ## Pennsylvania   131.085087 161.600897 188.866222  86.990862 172.999364
    ## Rhode Island    70.338112 103.903802 122.418871  42.185305 107.213106
    ## South Carolina  44.182915  27.556487  36.890920  89.248866  47.061343
    ## South Dakota   151.089113 179.948131 211.751576 104.455206 197.524378
    ## Tennessee       48.347596  77.884530 108.258117  12.614278  94.727662
    ## Texas           41.566092  72.362214  93.275988  32.744618  77.380230
    ## Utah           118.502700 148.276094 174.257338  76.438995 157.492635
    ## Vermont        190.370691 218.290472 251.489264 143.528569 237.435465
    ## Virginia        80.295330 110.646690 139.424711  36.421560 124.820912
    ## Washington      92.820472 122.147002 149.297857  51.204785 133.106574
    ## West Virginia  156.792411 185.640863 218.006078 110.071113 204.253715
    ## Wisconsin      183.775733 213.575397 242.312381 138.344245 226.457502
    ## Wyoming         75.507086 106.740105 135.380390  30.987255 121.720335
    ##                  Colorado Connecticut   Delaware    Florida    Georgia
    ## Alaska                                                                
    ## Arizona                                                               
    ## Arkansas                                                              
    ## California                                                            
    ## Colorado                                                              
    ## Connecticut     98.081191                                             
    ## Delaware        41.477825  128.210179                                 
    ## Florida        131.405822  226.303005  99.108325                      
    ## Georgia         25.093027  104.426529  33.245300 125.766490           
    ## Hawaii         159.179176   64.952367 192.366109 289.428575 167.128005
    ## Idaho           90.886413   25.280427 119.421313 217.665179  93.116057
    ## Illinois        47.669068  139.906469  18.151859  86.558708  45.002667
    ## Indiana         93.615063   16.316250 125.310534 222.923866  98.772871
    ## Iowa           152.079749   57.595573 182.709989 281.013523 156.445805
    ## Kansas          92.179716   14.173920 123.165945 221.082722  97.174071
    ## Kentucky       101.024749   26.343880 130.597435 228.332762 103.041448
    ## Louisiana       49.974994  140.398077  16.976749  87.670348  38.690567
    ## Maine          127.900156   37.647443 156.666652 255.152307 130.472564
    ## Maryland        97.300411  191.161947  63.577984  37.783859  89.505363
    ## Massachusetts   59.900000   40.165284  89.958324 187.043738  68.762272
    ## Michigan        51.454835  147.266561  26.531679  80.356269  47.398101
    ## Minnesota      134.764535   39.746698 166.141656 264.225831 140.327830
    ## Mississippi     68.664401  153.263955  36.479172  85.390456  51.355428
    ## Missouri        29.179788   70.695827  61.378905 157.491746  35.571337
    ## Montana        100.751675   24.746313 130.393136 228.327856 103.302081
    ## Nebraska       105.668349   17.865050 136.378334 234.464006 110.195735
    ## Nevada          48.834209  146.551083  35.053245  84.255860  50.567579
    ## New Hampshire  151.589182   57.043843 181.854695 280.247480 155.665603
    ## New Jersey      50.420829   51.196680  80.877995 176.897174  60.778286
    ## New Mexico      81.736222  176.580322  50.089320  51.147238  75.177723
    ## New York        52.278102  145.268166  24.189461  81.542198  50.643657
    ## North Carolina 138.977588  229.504009 102.861557  38.527912 127.335973
    ## North Dakota   165.750928   73.038962 195.272271 293.622751 168.611417
    ## Ohio            85.817539   15.036289 118.179186 215.466610  92.883637
    ## Oklahoma        57.099737   43.036031  87.195929 184.983918  61.759858
    ## Oregon          47.364121   53.242840  80.307223 176.810661  54.050902
    ## Pennsylvania   101.039596    8.027453 132.003674 229.949581 106.822376
    ## Rhode Island    43.879494   64.837104  66.208006 163.312461  50.992647
    ## South Carolina  82.641939  172.206765  48.725148  65.187115  69.194581
    ## South Dakota   125.302115   40.039231 154.422829 252.438844 127.294776
    ## Tennessee       28.005892   82.192761  53.343228 148.592867  23.427548
    ## Texas           14.501034   92.659160  39.665224 134.179917  22.851258
    ## Utah            85.625522   15.755951 118.514556 215.533849  94.292364
    ## Vermont        165.047690   76.617361 194.254601 292.020085 166.724923
    ## Virginia        53.416851   49.307200  82.678716 180.286023  56.028743
    ## Washington      60.642065   38.334058  93.604327 190.555635  68.590962
    ## West Virginia  132.360115   47.895720 160.562418 258.460539 133.229651
    ## Wisconsin      154.115217   58.056696 185.194195 283.423799 159.511880
    ## Wyoming         52.036718   54.060152  77.934909 176.112606  52.119094
    ##                    Hawaii      Idaho   Illinois    Indiana       Iowa
    ## Alaska                                                               
    ## Arizona                                                              
    ## Arkansas                                                             
    ## California                                                           
    ## Colorado                                                             
    ## Connecticut                                                          
    ## Delaware                                                             
    ## Florida                                                              
    ## Georgia                                                              
    ## Hawaii                                                               
    ## Idaho           79.751426                                            
    ## Illinois       203.099606 132.811445                                 
    ## Indiana         69.406412  15.407790 137.256111                      
    ## Iowa            29.407822  64.137119 195.329286  58.584042           
    ## Kansas          71.100844  13.964240 135.278823   3.929377  60.177487
    ## Kentucky        70.459705  13.409698 143.599373  14.606163  53.993055
    ## Louisiana      203.970611 130.433278  17.811232 136.255936 193.966621
    ## Maine           50.566788  37.672404 170.033320  36.003472  27.879383
    ## Maryland       254.687573 181.189542  53.593376 187.179192 244.930725
    ## Massachusetts  103.097139  42.539981 100.495224  41.544314  97.277130
    ## Michigan       209.833863 138.390968  15.591664 143.065789 201.381355
    ## Minnesota       31.620405  49.482320 178.213636  41.706834  18.713899
    ## Mississippi    216.832308 140.041637  41.244394 147.822258 203.972670
    ## Missouri       132.931148  62.104428  72.315973  65.613108 124.035680
    ## Montana         69.885120  11.764353 143.447273  13.512957  53.529898
    ## Nebraska        59.930710  19.904271 148.806787  12.596031  46.609548
    ## Nevada         207.733603 138.767431  22.366046 142.221658 200.738860
    ## New Hampshire   31.220666  63.208702 194.607657  58.096988   2.291288
    ## New Jersey     113.187323  52.822344  90.399336  51.931493 108.241813
    ## New Mexico     239.726553 166.969608  39.135789 172.481448 230.493557
    ## New York       208.186095 138.541907   6.236986 142.699755 200.856292
    ## North Carolina 293.600238 217.443717  96.214188 225.019221 281.504316
    ## North Dakota    41.335941  75.999013 208.585834  72.757474  17.548789
    ## Ohio            74.467711  22.692069 129.311136  12.213517  67.439009
    ## Oklahoma       106.074172  34.736724  99.294713  38.136072  96.130380
    ## Oregon         114.490043  43.855444  91.729712  46.842075 105.072784
    ## Pennsylvania    61.237978  23.112334 143.769329  11.662761  52.485903
    ## Rhode Island   128.628224  63.564534  77.048621  66.187083 121.796716
    ## South Carolina 235.800975 159.765860  46.295248 167.030207 223.795174
    ## South Dakota    55.686713  35.219313 167.874953  34.753417  32.385336
    ## Tennessee      144.385941  70.161599  65.675338  75.708718 133.388005
    ## Texas          155.296008  86.410069  48.171984  89.551661 147.871194
    ## Utah            74.139733  27.423530 129.240280  17.135052  68.996812
    ## Vermont         51.919264  75.346931 207.925660  73.722724  26.249000
    ## Virginia       111.850302  38.132139  95.202416  43.067157 100.816913
    ## Washington      99.692979  33.644613 104.698615  33.545193  91.663788
    ## West Virginia   57.271022  42.185543 174.350738  42.885196  31.068473
    ## Wisconsin       20.824265  68.151009 197.332410  61.042608   9.508417
    ## Wyoming        117.377212  41.672533  91.414003  48.562537 105.231412
    ##                    Kansas   Kentucky  Louisiana      Maine   Maryland
    ## Alaska                                                               
    ## Arizona                                                              
    ## Arkansas                                                             
    ## California                                                           
    ## Colorado                                                             
    ## Connecticut                                                          
    ## Delaware                                                             
    ## Florida                                                              
    ## Georgia                                                              
    ## Hawaii                                                               
    ## Idaho                                                                
    ## Illinois                                                             
    ## Indiana                                                              
    ## Iowa                                                                 
    ## Kansas                                                               
    ## Kentucky        15.766420                                            
    ## Louisiana      134.394940 140.937220                                 
    ## Maine           36.989863  28.407921 167.825058                      
    ## Maryland       185.337881 191.939600  51.479802 218.699886           
    ## Massachusetts   39.018585  52.125713 102.551499  74.763226 152.659294
    ## Michigan       141.398798 148.859665  16.652327 175.949680  46.129492
    ## Minnesota       43.237715  40.199005 177.605124  19.919086 228.528707
    ## Mississippi    146.023354 150.351588  24.708298 176.939227  48.451316
    ## Missouri        64.015936  72.298686  71.651657  99.246007 122.059207
    ## Montana         14.406943   3.834058 141.035457  27.733914 191.924595
    ## Nebraska        13.789126  13.349157 147.582858  23.717715 198.508665
    ## Nevada         140.770878 148.923940  28.472443 176.131343  53.217009
    ## New Hampshire   59.594127  53.141321 193.137723  26.530925 244.109668
    ## New Jersey      49.674943  62.293980  93.298231  85.843404 143.042686
    ## New Mexico     170.716051 177.630318  37.762548 204.553123  15.890249
    ## New York       140.757309 149.261515  21.417283 175.732439  49.798896
    ## North Carolina 223.108964 228.131388  90.708158 254.439973  44.640565
    ## North Dakota    74.333909  65.728304 206.240563  38.664454 257.069057
    ## Ohio            10.920165  26.110726 129.569479  46.443514 180.335687
    ## Oklahoma        36.115924  45.202876  98.439220  71.288779 149.281379
    ## Oregon          45.452173  54.009629  90.893674  80.635538 141.153144
    ## Pennsylvania    11.256109  20.555291 143.600487  32.218783 194.556958
    ## Rhode Island    63.425941  74.523084  80.020060  97.872059 129.300657
    ## South Carolina 165.259826 170.224939  35.001286 196.957813  28.977578
    ## South Dakota    36.247483  25.001200 165.023998   8.537564 215.780560
    ## Tennessee       74.222975  80.091260  61.619234 107.596561 112.305031
    ## Texas           87.710547  96.652160  50.181471 123.250355  99.886185
    ## Utah            15.901258  31.477135 130.331616  49.388460 180.716961
    ## Vermont         75.535952  64.832554 204.578200  39.969613 255.122265
    ## Virginia        41.273963  48.485049  93.315915  75.368229 144.257582
    ## Washington      31.941196  43.214581 104.933122  68.338642 155.296008
    ## West Virginia   44.280696  31.906112 170.919572  12.775367 221.627187
    ## Wisconsin       62.509199  58.417977 196.748062  33.678628 247.739157
    ## Wyoming         46.458584  52.696300  88.867992  79.043849 139.782295
    ##                Massachusetts   Michigan  Minnesota Mississippi   Missouri
    ## Alaska                                                                   
    ## Arizona                                                                  
    ## Arkansas                                                                 
    ## California                                                               
    ## Colorado                                                                 
    ## Connecticut                                                              
    ## Delaware                                                                 
    ## Florida                                                                  
    ## Georgia                                                                  
    ## Hawaii                                                                   
    ## Idaho                                                                    
    ## Illinois                                                                 
    ## Indiana                                                                  
    ## Iowa                                                                     
    ## Kansas                                                                   
    ## Kentucky                                                                 
    ## Louisiana                                                                
    ## Maine                                                                    
    ## Maryland                                                                 
    ## Massachusetts                                                            
    ## Michigan          108.488386                                             
    ## Minnesota          79.340091 184.524795                                  
    ## Mississippi       117.976820  35.440090 188.778706                       
    ## Missouri           35.053816  77.473996 107.091456   86.084958           
    ## Montana            51.250073 148.808266  39.384515  150.610425  72.098821
    ## Nebraska           52.326380 154.789535  30.349959  158.469555  77.453083
    ## Nevada            107.554312  13.297368 183.527818   47.627933  76.968045
    ## New Hampshire      96.729158 200.707150  18.828701  202.982167 123.427307
    ## New Jersey         11.456439  98.634578  90.195898  110.016272  28.511752
    ## New Mexico        137.911711  30.421867 213.907760   39.988623 107.097946
    ## New York          105.673696  15.066519 183.630063   43.531598  77.722712
    ## North Carolina    192.400624  89.032634 266.032949   78.074388 161.457146
    ## North Dakota      112.209447 214.244090  35.698319  214.769947 137.364661
    ## Ohio               31.231715 135.781921  49.481411  142.751287  58.635569
    ## Oklahoma           17.650212 105.405218  79.285686  111.079521  28.390139
    ## Oregon             24.356724  96.697880  88.216778  103.938828  19.698223
    ## Pennsylvania       44.984108 150.488139  34.712534  155.864942  73.295157
    ## Rhode Island       26.343880  86.740590 104.350611   96.502487  27.062335
    ## South Carolina    135.674021  37.630440 208.249010   21.167192 103.666050
    ## South Dakota       74.710173 173.113200  25.349951  173.492882  96.711943
    ## Tennessee          48.854887  69.155260 117.299829   73.283354  15.502580
    ## Texas              53.689198  55.177169 130.573198   68.863053  25.494705
    ## Utah               30.182777 135.974446  50.638424  144.281149  59.377858
    ## Vermont           114.196541 212.796194  41.784447  211.879730 136.672016
    ## Virginia           23.857284 100.709086  84.452827  105.074830  24.279621
    ## Washington         16.067669 110.660833  74.211724  118.601096  33.570821
    ## West Virginia      82.405643 179.464760  29.160933  178.544112 103.624804
    ## Wisconsin          98.033107 203.835080  19.437592  207.706379 126.430692
    ## Wyoming            27.843312  97.161412  89.298936   99.743371  23.507446
    ##                   Montana   Nebraska     Nevada New Hampshire New Jersey
    ## Alaska                                                                  
    ## Arizona                                                                 
    ## Arkansas                                                                
    ## California                                                              
    ## Colorado                                                                
    ## Connecticut                                                             
    ## Delaware                                                                
    ## Florida                                                                 
    ## Georgia                                                                 
    ## Hawaii                                                                  
    ## Idaho                                                                   
    ## Illinois                                                                
    ## Indiana                                                                 
    ## Iowa                                                                    
    ## Kansas                                                                  
    ## Kentucky                                                                
    ## Louisiana                                                               
    ## Maine                                                                   
    ## Maryland                                                                
    ## Massachusetts                                                           
    ## Michigan                                                                
    ## Minnesota                                                               
    ## Mississippi                                                             
    ## Missouri                                                                
    ## Montana                                                                 
    ## Nebraska        11.528226                                               
    ## Nevada         148.820697 154.251937                                    
    ## New Hampshire   52.686051  45.987390 200.210539                         
    ## New Jersey      61.674306  63.189398  97.344132    107.738480           
    ## New Mexico     177.596875 183.974917  37.467986    229.732997 128.179132
    ## New York       149.111032 154.332109  20.645096    200.163833  95.399057
    ## North Carolina 228.247870 235.774999  97.034272    280.505561 183.462939
    ## North Dakota    65.474041  60.579617 214.115973     17.161876 123.275342
    ## Ohio            25.133444  22.934908 134.495985     67.071976  41.518309
    ## Oklahoma        44.747290  49.543314 105.249038     95.448939  22.518437
    ## Oregon          53.512802  58.636166  95.797599    104.522151  24.505102
    ## Pennsylvania    19.296114  11.070682 149.663021     51.998077  55.806989
    ## Rhode Island    73.846936  76.661920  87.285337    121.050114  18.848077
    ## South Carolina 170.390053 177.941030  48.734895    222.863837 127.057821
    ## South Dakota    24.714368  23.641912 173.276657     31.237477  85.521693
    ## Tennessee       80.243941  87.134207  70.326453    132.649802  42.898135
    ## Texas           96.543772 101.373369  54.977268    147.242521  43.794749
    ## Utah            30.001500  26.271087 134.311615     68.744236  40.453059
    ## Vermont         64.834250  62.036280 212.903828     25.688519 125.119143
    ## Virginia        48.308798  54.334888 100.964251    100.081966  26.264425
    ## Washington      42.379712  45.433248 109.417914     91.189363  22.766642
    ## West Virginia   32.101402  31.996875 179.983721     29.631065  93.151167
    ## Wisconsin       57.861213  49.521510 202.872374     10.860018 108.867075
    ## Wyoming         52.481235  59.093654  98.363205    104.361391  29.250641
    ##                New Mexico   New York North Carolina North Dakota       Ohio
    ## Alaska                                                                     
    ## Arizona                                                                    
    ## Arkansas                                                                   
    ## California                                                                 
    ## Colorado                                                                   
    ## Connecticut                                                                
    ## Delaware                                                                   
    ## Florida                                                                    
    ## Georgia                                                                    
    ## Hawaii                                                                     
    ## Idaho                                                                      
    ## Illinois                                                                   
    ## Indiana                                                                    
    ## Iowa                                                                       
    ## Kansas                                                                     
    ## Kentucky                                                                   
    ## Louisiana                                                                  
    ## Maine                                                                      
    ## Maryland                                                                   
    ## Massachusetts                                                              
    ## Michigan                                                                   
    ## Minnesota                                                                  
    ## Mississippi                                                                
    ## Missouri                                                                   
    ## Montana                                                                    
    ## Nebraska                                                                   
    ## Nevada                                                                     
    ## New Hampshire                                                              
    ## New Jersey                                                                 
    ## New Mexico                                                                 
    ## New York        35.399011                                                  
    ## North Carolina  59.896244  93.132218                                       
    ## North Dakota   242.906155 214.253425     292.388919                        
    ## Ohio           165.472959 134.586515     219.202144    82.626025           
    ## Oklahoma       134.645646 104.835395     187.566442   109.576138  31.819019
    ## Oregon         126.234266  97.132281     180.021804   118.430613  40.659193
    ## Pennsylvania   179.907893 149.159244     232.672151    67.771749  15.755951
    ## Rhode Island   115.067111  82.323326     168.777961   136.006470  56.980874
    ## South Carolina  24.923082  45.747678      58.445872   234.921263 161.436117
    ## South Dakota   201.633951 173.594873     251.190227    41.487950  46.284015
    ## Tennessee       97.776684  71.344586     150.045593   145.643125  70.321121
    ## Texas           84.860179  53.365907     140.746048   161.569954  81.436908
    ## Utah           165.761515 134.404799     220.127872    84.676561   6.637771
    ## Vermont        241.110867 213.666141     289.535231    13.044922  84.634804
    ## Virginia       129.724207 100.841063     182.006621   113.669917  37.972753
    ## Washington     140.351594 110.001909     194.501954   105.869967  25.747427
    ## West Virginia  207.676022 180.137170     256.264570    36.728871  54.460720
    ## Wisconsin      233.176178 202.749451     285.014473    23.737944  68.588993
    ## Wyoming        125.576311  97.230345     176.747532   117.545268  44.044182
    ##                  Oklahoma     Oregon Pennsylvania Rhode Island South Carolina
    ## Alaska                                                                       
    ## Arizona                                                                      
    ## Arkansas                                                                     
    ## California                                                                   
    ## Colorado                                                                     
    ## Connecticut                                                                  
    ## Delaware                                                                     
    ## Florida                                                                      
    ## Georgia                                                                      
    ## Hawaii                                                                       
    ## Idaho                                                                        
    ## Illinois                                                                     
    ## Indiana                                                                      
    ## Iowa                                                                         
    ## Kansas                                                                       
    ## Kentucky                                                                     
    ## Louisiana                                                                    
    ## Maine                                                                        
    ## Maryland                                                                     
    ## Massachusetts                                                                
    ## Michigan                                                                     
    ## Minnesota                                                                    
    ## Mississippi                                                                  
    ## Missouri                                                                     
    ## Montana                                                                      
    ## Nebraska                                                                     
    ## Nevada                                                                       
    ## New Hampshire                                                                
    ## New Jersey                                                                   
    ## New Mexico                                                                   
    ## New York                                                                     
    ## North Carolina                                                               
    ## North Dakota                                                                 
    ## Ohio                                                                         
    ## Oklahoma                                                                     
    ## Oregon          12.424975                                                    
    ## Pennsylvania    45.465371  55.166294                                         
    ## Rhode Island    32.204503  32.684094    70.006928                            
    ## South Carolina 129.811748 122.055274   175.009628   113.440028               
    ## South Dakota    69.380689  78.015768    33.758851    97.613575     193.557356
    ## Tennessee       39.257738  31.299361    84.170125    37.709415      91.775814
    ## Texas           52.071681  44.813837    96.136986    34.063617      84.379441
    ## Utah            33.540572  41.639524    18.264994    56.375527     162.574906
    ## Vermont        109.552727 117.817231    70.671777   137.516726     232.149801
    ## Virginia         7.355270  10.579225    51.180856    32.859854     124.064701
    ## Washington      10.305338  15.569843    40.681445    36.847931     136.758364
    ## West Virginia   76.526466  85.256319    41.781814   104.686628     198.833926
    ## Wisconsin       98.532431 107.631501    53.623689   122.836843     227.323844
    ## Wyoming         13.542526  15.630099    56.300444    31.029824     119.051963
    ##                South Dakota  Tennessee      Texas       Utah    Vermont
    ## Alaska                                                                 
    ## Arizona                                                                
    ## Arkansas                                                               
    ## California                                                             
    ## Colorado                                                               
    ## Connecticut                                                            
    ## Delaware                                                               
    ## Florida                                                                
    ## Georgia                                                                
    ## Hawaii                                                                 
    ## Idaho                                                                  
    ## Illinois                                                               
    ## Indiana                                                                
    ## Iowa                                                                   
    ## Kansas                                                                 
    ## Kentucky                                                               
    ## Louisiana                                                              
    ## Maine                                                                  
    ## Maryland                                                               
    ## Massachusetts                                                          
    ## Michigan                                                               
    ## Minnesota                                                              
    ## Mississippi                                                            
    ## Missouri                                                               
    ## Montana                                                                
    ## Nebraska                                                               
    ## Nevada                                                                 
    ## New Hampshire                                                          
    ## New Jersey                                                             
    ## New Mexico                                                             
    ## New York                                                               
    ## North Carolina                                                         
    ## North Dakota                                                           
    ## Ohio                                                                   
    ## Oklahoma                                                               
    ## Oregon                                                                 
    ## Pennsylvania                                                           
    ## Rhode Island                                                           
    ## South Carolina                                                         
    ## South Dakota                                                           
    ## Tennessee        104.341602                                            
    ## Texas            121.204373  24.742878                                 
    ## Utah              49.833423  71.979164  81.596630                      
    ## Vermont           40.225862 143.862747 161.331150  87.326342           
    ## Virginia          72.859454  33.174237  48.525045  40.223501 112.937770
    ## Washington        66.667833  46.153331  57.106742  26.182628 106.387217
    ## West Virginia      8.766984 110.521536 128.032965  58.251266  33.968515
    ## Wisconsin         39.184691 136.548782 149.726751  69.510934  34.370336
    ## Wyoming           76.595300  29.977492  46.182464  46.338429 116.591252
    ##                  Virginia Washington West Virginia  Wisconsin
    ## Alaska                                                       
    ## Arizona                                                      
    ## Arkansas                                                     
    ## California                                                   
    ## Colorado                                                     
    ## Connecticut                                                  
    ## Delaware                                                     
    ## Florida                                                      
    ## Georgia                                                      
    ## Hawaii                                                       
    ## Idaho                                                        
    ## Illinois                                                     
    ## Indiana                                                      
    ## Iowa                                                         
    ## Kansas                                                       
    ## Kentucky                                                     
    ## Louisiana                                                    
    ## Maine                                                        
    ## Maryland                                                     
    ## Massachusetts                                                
    ## Michigan                                                     
    ## Minnesota                                                    
    ## Mississippi                                                  
    ## Missouri                                                     
    ## Montana                                                      
    ## Nebraska                                                     
    ## Nevada                                                       
    ## New Hampshire                                                
    ## New Jersey                                                   
    ## New Mexico                                                   
    ## New York                                                     
    ## North Carolina                                               
    ## North Dakota                                                 
    ## Ohio                                                         
    ## Oklahoma                                                     
    ## Oregon                                                       
    ## Pennsylvania                                                 
    ## Rhode Island                                                 
    ## South Carolina                                               
    ## South Dakota                                                 
    ## Tennessee                                                    
    ## Texas                                                        
    ## Utah                                                         
    ## Vermont                                                      
    ## Virginia                                                     
    ## Washington      16.477257                                    
    ## West Virginia   79.616581  74.434535                         
    ## Wisconsin      103.686161  93.552766     39.049456           
    ## Wyoming          7.930952  23.349518     82.957218 108.354418

``` r
# hclust 함수
## 1. 최단거리법
US.single <- hclust(US.dist, method = 'single')
plot(US.single) # 덴드로그램
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-1-1.png)

``` r
## 2. 최장거리법
US.complete <- hclust(US.dist, method = 'complete')
plot(US.complete)
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-1-2.png)

``` r
## 3. 평균거리법
US.average <- hclust(US.dist, method = 'average')
plot(US.average)
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-1-3.png)

※ cutree함수 : 계층적 군집의 결과를 이용하여 tree의 높이(h)나 그룹의
수(k)를 옵션으로 지정

``` r
group <- cutree(US.average, k=6)
group
```

    ##        Alabama         Alaska        Arizona       Arkansas     California 
    ##              1              1              1              2              1 
    ##       Colorado    Connecticut       Delaware        Florida        Georgia 
    ##              2              3              1              4              2 
    ##         Hawaii          Idaho       Illinois        Indiana           Iowa 
    ##              5              3              1              3              5 
    ##         Kansas       Kentucky      Louisiana          Maine       Maryland 
    ##              3              3              1              5              1 
    ##  Massachusetts       Michigan      Minnesota    Mississippi       Missouri 
    ##              6              1              5              1              2 
    ##        Montana       Nebraska         Nevada  New Hampshire     New Jersey 
    ##              3              3              1              5              6 
    ##     New Mexico       New York North Carolina   North Dakota           Ohio 
    ##              1              1              4              5              3 
    ##       Oklahoma         Oregon   Pennsylvania   Rhode Island South Carolina 
    ##              6              6              3              6              1 
    ##   South Dakota      Tennessee          Texas           Utah        Vermont 
    ##              5              2              2              3              5 
    ##       Virginia     Washington  West Virginia      Wisconsin        Wyoming 
    ##              6              6              5              5              6

※ rect.hclust함수 : plot함수를 통한 그래프에서 각각의 그룹을 사각형으로
구분지어 나타냄

``` r
plot(US.average)
rect.hclust(US.average,k=6,border = 'red')
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-3-1.png)

### 3절. 비계층적 군집분석

#### 1. 개요

n개의 개체를 k개의 군집으로 나누어 모든 가능한 방법을 점검해 최적화한
군집 형성

#### 2. K-평균 군집분석(k-means clustering)

-   방법

    1.  원하는 군집의 개수와 초기 값(seed)들을 정해 seed 중심으로 군집
        형성
    2.  각 데이터를 거리가 가장 가까운 seed가 있는 군집으로 분류
    3.  각 군집의 seed 값 다시 계산

##### R

-   kmeans(data,centers,…)

    -   centers : 군집의 개수 설정

-   Nbclust(data, min.nc. max.nc, method,…)\\  
    최적의 k 선정

    -   min.nc : 최소 군집의 수

    -   max.nc : 최대 군집의 수

    -   method : 군집분석 방법
        (‘kmeans’,‘median’,‘single’,‘complete’,‘average’)

``` r
train.data <- train[,-1]
credit.kmeans <- kmeans(train.data, centers = 2)
credit.kmeans
```

    ## K-means clustering with 2 clusters of sizes 123, 577
    ## 
    ## Cluster means:
    ##   Account.Balance Duration.of.Credit..month. Payment.Status.of.Previous.Credit
    ## 1        2.536585                   34.94309                          2.487805
    ## 2        2.549393                   17.83189                          2.604853
    ##    Purpose Credit.Amount Value.Savings.Stocks Length.of.current.employment
    ## 1 3.097561      8383.902             2.349593                     3.430894
    ## 2 2.677643      2169.965             2.081456                     3.355286
    ##   Instalment.per.cent Sex...Marital.Status Guarantors
    ## 1            2.430894             2.707317   1.081301
    ## 2            3.062392             2.679376   1.150780
    ##   Duration.in.Current.address Most.valuable.available.asset Age..years.
    ## 1                    2.918699                      2.975610    37.65854
    ## 2                    2.883882                      2.227036    35.61352
    ##   Concurrent.Credits Type.of.apartment No.of.Credits.at.this.Bank Occupation
    ## 1           2.528455          2.121951                   1.520325   3.178862
    ## 2           2.705373          1.897747                   1.415945   2.811092
    ##   No.of.dependents Telephone Foreign.Worker
    ## 1         1.170732  1.609756       1.024390
    ## 2         1.152513  1.339688       1.046794
    ## 
    ## Clustering vector:
    ## 836 679 129 930 509 471 299 270 978 187 307 597 277 874 950 494 330 775 841 591 
    ##   1   2   2   1   2   2   2   2   1   2   2   2   2   1   2   2   1   2   2   2 
    ## 725  37 105 729 878 485 677 802 987 382 601 940 801 852 931 326 984 554 422 111 
    ##   2   2   2   1   1   2   2   2   1   2   1   1   2   2   2   2   2   2   2   2 
    ## 404 924 532 506 556 889 343 582 121  40 684 537 375 248 198 378  39 435 810 390 
    ##   2   1   2   2   2   2   2   2   2   2   2   2   2   2   2   1   2   2   2   2 
    ## 280 672 526 642  45 402  22 718 742 193 371 499 104 965 767 492 838 616 615 843 
    ##   2   2   1   1   2   2   2   2   2   1   1   2   1   2   2   2   2   2   1   2 
    ## 465 525 808 977 176 345 791 110  84 871  29 141 252 733 620 304 545 557 661 287 
    ##   1   2   1   1   2   2   2   2   2   2   2   2   1   2   2   2   2   1   2   2 
    ## 614 145 329 487 855 851 630 498 858 816 619 576 490 736 103 316  51 907 290 650 
    ##   2   2   2   2   2   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2 
    ## 998 811 282 143 442 285 682  48 501 716 511 295 536 693 214 918 737 339 346 675 
    ##   1   1   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2 
    ##  43   1 910 590 959 796 628 233 293 573 369 451  86 483 327 622 355 819 812  49 
    ##   2   2   1   2   2   2   2   1   2   1   2   2   2   2   2   1   2   2   1   2 
    ## 361 885 242 440 758 817 818 247 751 219 135 961 958 377 408 884 565 467 356 130 
    ##   2   2   1   2   2   2   2   2   2   1   2   1   2   2   2   2   2   2   1   2 
    ## 891  65 842 359 992 124  77 218 610 194  19 273 418 543 419 686 403 749 587  16 
    ##   1   2   2   2   1   2   2   2   2   2   2   2   1   2   2   2   2   2   1   2 
    ## 951 777 604 634 664 138 719 500 761 939 229 423 421 140 126 938 508 854 968 271 
    ##   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   1   2   2   2 
    ## 821 577 512 849 504 457 358 724 127 645  41 548 305 413 955 880 309 773 441 117 
    ##   1   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2   2   2   2 
    ## 764 470 900 562 336 349  72 857 474 168 872 788 455 783 822 625 234 484 952  73 
    ##   1   2   2   2   2   2   2   2   2   2   1   2   2   1   1   1   2   1   2   2 
    ## 539 553  15 762 294  62 941 644  35 381 814 820 697 846 665  31 549  28 735 148 
    ##   2   2   2   2   2   2   1   1   2   2   2   2   2   2   2   2   2   2   1   2 
    ## 772 572 284 334 980 268  93 756 300 834 976 241  33 883 437 792 848 217 108 781 
    ##   2   1   2   2   2   2   2   2   2   2   1   2   1   1   2   2   1   2   2   1 
    ## 993 209 338 609 584 824 568 434 201 354 357 755 973 514 116 643 962 853 701 668 
    ##   1   1   2   2   2   2   2   2   2   2   2   1   2   2   1   1   2   2   1   2 
    ## 439 197 220 462 994 235 513 752 173  83 673 407 324 185 922 180 464 493 444 167 
    ##   2   1   2   1   2   2   2   2   2   1   2   2   2   2   2   1   2   2   2   1 
    ## 982 995 291 653 833 867 839 862 657  56  25  81 472 898 985 647 480 928   3 179 
    ##   2   1   2   2   1   2   1   2   2   2   2   2   2   2   1   2   2   2   2   2 
    ## 161 384 436 720 260  60 448 488 181 510 133 618 428 547 827 279 658 948 611 721 
    ##   2   2   2   1   2   2   2   2   2   2   2   2   2   2   2   2   2   1   2   1 
    ## 150 932 169 598 823 702 530 956 789  91 164 544 479 825 119 920 790 607 731 638 
    ##   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2   1   2   2   1   2 
    ##  89 533 981 690 648  71 639 315 831 414 663 570 972 546 674 574 705 670 832 770 
    ##   2   2   2   2   1   2   2   2   2   2   2   1   1   2   2   2   2   2   2   2 
    ## 392 281   5 964 925  20 183 694  79 687  69 473 798 296 909 132  42 894 966 887 
    ##   2   2   2   2   2   1   1   2   2   2   2   1   2   1   2   2   2   2   1   2 
    ## 397 264 177 368 433 139 520 320 115 453 450 551 396 799 813 159 606 495 109 519 
    ##   1   2   2   2   2   2   1   2   2   1   2   2   2   2   2   1   2   2   2   1 
    ## 740 393 704 936 112  27 222 266 158 765 654 386 175 712 261 166 552 340  92 412 
    ##   1   2   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2   2   2 
    ##  99 516 128 646 919 943 805 192 410  85 213 302 311 208 957 895 383 216 988 259 
    ##   2   2   2   1   2   2   2   2   1   2   2   2   2   2   2   2   1   2   2   2 
    ## 652  87 743 768 906 303 937 240 868 312   4 711  58 308 975 757 829 342 870 626 
    ##   2   2   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2   2   2 
    ## 845 203 122  44 571 267 734 873 100 313 134 468 232 310 360  11 608 923 631 482 
    ##   1   2   1   2   2   2   2   2   1   2   2   1   2   1   2   2   2   2   2   2 
    ## 649 256 265  54 146 524 911 236 328 215   6 481 555 515 250 579 258 869 446 288 
    ##   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2 
    ## 744 567 593 847 806 605 205 243 780 946 399  55 182 581  61 348 635 921 662 137 
    ##   1   1   1   2   2   2   2   2   2   1   2   1   2   2   2   2   2   2   2   2 
    ## 325 592 362  66 101 901 245 206 600 974 627 431 380 411 153  17 190 708 478 680 
    ##   2   2   2   2   2   2   2   2   2   1   2   2   1   2   1   2   2   2   2   2 
    ## 699 621 586 954 276 766 558 454 563 283 353 426 226 184  36 341  52 162 807 912 
    ##   2   1   2   1   2   2   2   1   1   2   1   2   2   2   2   2   2   2   2   2 
    ##  67 602 882 876 935 335 828 507 363 489 395 286 367 689 425  13 613 905   7  82 
    ##   2   2   2   2   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2 
    ## 389 257 449 420 960 913 529 710 225 942 306 727 538 771 469 594  97 715 466 651 
    ##   2   2   2   2   2   2   2   1   2   2   2   2   2   2   2   2   2   2   2   2 
    ## 732 856 207 902 929 703 859 803 476 947  80 477 916 251  12 560 406 350 521   8 
    ##   1   2   2   2   1   1   2   2   2   2   2   2   2   2   1   2   1   2   2   2 
    ## 983 904 787  30   9 879 333 518 860 278 564 102 424 118 713 211 990 917 722 365 
    ##   2   2   2   2   2   2   2   2   2   2   2   2   2   2   1   2   2   2   2   2 
    ## 
    ## Within cluster sum of squares by cluster:
    ## [1] 934241104 812299276
    ##  (between_SS / total_SS =  69.2 %)
    ## 
    ## Available components:
    ## 
    ## [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
    ## [6] "betweenss"    "size"         "iter"         "ifault"

``` r
# 정분류율
kmeans.table <- table(train$Creditability, credit.kmeans$cluster)
kmeans.table
```

    ##    
    ##       1   2
    ##   0  53 163
    ##   1  70 414

``` r
(kmeans.table[1,1] + kmeans.table[2,2])/sum(kmeans.table)
```

    ## [1] 0.6671429

※ 전체 변동에서 군집 간 변동이 차지하는 비율(between_SS / total_SS)이
1에 가까울수록 잘 군집화

=\> between_SS / total_SS = 69.2%이므로 좋은 모델이라고 할 수 없다.

=\> 정분류율 0.6671이므로 좋은 성능을 가지지 않았다고 판단

``` r
# NbClust함수 => 
#install.packages('NbClust')
library(NbClust)

nc <- NbClust(train.data, min.nc = 2, max.nc = 15, method = 'kmeans')
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-5-1.png)

    ## *** : The Hubert index is a graphical method of determining the number of clusters.
    ##                 In the plot of Hubert index, we seek a significant knee that corresponds to a 
    ##                 significant increase of the value of the measure i.e the significant peak in Hubert
    ##                 index second differences plot. 
    ## 

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-5-2.png)

    ## *** : The D index is a graphical method of determining the number of clusters. 
    ##                 In the plot of D index, we seek a significant knee (the significant peak in Dindex
    ##                 second differences plot) that corresponds to a significant increase of the value of
    ##                 the measure. 
    ##  
    ## ******************************************************************* 
    ## * Among all indices:                                                
    ## * 5 proposed 2 as the best number of clusters 
    ## * 5 proposed 3 as the best number of clusters 
    ## * 5 proposed 4 as the best number of clusters 
    ## * 1 proposed 6 as the best number of clusters 
    ## * 1 proposed 10 as the best number of clusters 
    ## * 3 proposed 11 as the best number of clusters 
    ## * 4 proposed 15 as the best number of clusters 
    ## 
    ##                    ***** Conclusion *****                            
    ##  
    ## * According to the majority rule, the best number of clusters is  2 
    ##  
    ##  
    ## *******************************************************************

### 4절. 혼합 분포 군집

#### 1. 개요

모형 기반의 군집 방법, 데이터가 k개의 모수적 모형의 가중합으로 표현되는
모집단 모형으로부터 나왔다는 가정하에서 모수와 가중치 추정

#### 2. 혼합 분모모형으로 설명할 수 있는 데이터의 형태

#### 3. EM(Expectation-Maximization) 알고리즘의 진행 과정

-   E-단계 : 잠재변수 Z의 기대치 계산

-   M-단계 : 잠재변수 Z의 기대치를 이용하여 파라미터 추정

#### 4. EM 알고리즘의 진행 과정

#### 5. R을 이용한 혼합 분포 군집분석 (mclust 패키지)

-   Mclust(data, G, …)

    -   data : 분석하고자 하는 데이터(수치형 변수만)

    -   G : BIC를 계산할 혼합분포 클러스터의 수를 지정 (default = 1:9)

``` r
#install.packages('mclust')
library(mclust)
```

    ## Package 'mclust' version 6.1
    ## Type 'citation("mclust")' for citing this R package in publications.

``` r
mc <- Mclust(iris[,1:4],G=3)
summary(mc,parameters = T)
```

    ## ---------------------------------------------------- 
    ## Gaussian finite mixture model fitted by EM algorithm 
    ## ---------------------------------------------------- 
    ## 
    ## Mclust VEV (ellipsoidal, equal shape) model with 3 components: 
    ## 
    ##  log-likelihood   n df       BIC       ICL
    ##        -186.074 150 38 -562.5522 -566.4673
    ## 
    ## Clustering table:
    ##  1  2  3 
    ## 50 45 55 
    ## 
    ## Mixing probabilities:
    ##         1         2         3 
    ## 0.3333333 0.3005423 0.3661243 
    ## 
    ## Means:
    ##               [,1]     [,2]     [,3]
    ## Sepal.Length 5.006 5.915044 6.546807
    ## Sepal.Width  3.428 2.777451 2.949613
    ## Petal.Length 1.462 4.204002 5.482252
    ## Petal.Width  0.246 1.298935 1.985523
    ## 
    ## Variances:
    ## [,,1]
    ##              Sepal.Length Sepal.Width Petal.Length Petal.Width
    ## Sepal.Length   0.13320850  0.10938369  0.019191764 0.011585649
    ## Sepal.Width    0.10938369  0.15495369  0.012096999 0.010010130
    ## Petal.Length   0.01919176  0.01209700  0.028275400 0.005818274
    ## Petal.Width    0.01158565  0.01001013  0.005818274 0.010695632
    ## [,,2]
    ##              Sepal.Length Sepal.Width Petal.Length Petal.Width
    ## Sepal.Length   0.22572159  0.07613348   0.14689934  0.04335826
    ## Sepal.Width    0.07613348  0.08024338   0.07372331  0.03435893
    ## Petal.Length   0.14689934  0.07372331   0.16613979  0.04953078
    ## Petal.Width    0.04335826  0.03435893   0.04953078  0.03338619
    ## [,,3]
    ##              Sepal.Length Sepal.Width Petal.Length Petal.Width
    ## Sepal.Length   0.42943106  0.10784274   0.33452389  0.06538369
    ## Sepal.Width    0.10784274  0.11596343   0.08905176  0.06134034
    ## Petal.Length   0.33452389  0.08905176   0.36422115  0.08706895
    ## Petal.Width    0.06538369  0.06134034   0.08706895  0.08663823

``` r
# 시각화
plot.Mclust(mc)
```

![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-6-1.png)![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-6-2.png)![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-6-3.png)![](3장.-군집분석_files/figure-markdown_github/unnamed-chunk-6-4.png)
